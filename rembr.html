
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset=utf-8>
    <meta http-equiv=x-ua-compatible content="ie=edge">
    <meta name=keywords content="">
    <meta name=description content="xxxxxxxxxxxxxxxxx平台">
    <title>用户登录 - xxxxxxxxxx</title>
    <script src="./js/jquery-1.10.2.min.js"></script>
 
    <script language="javascript" type="text/javascript">
        function checkInCorrect()      //判断用户名和密码是否为空
        {
            if (document.getElementById('username').value == "") {
                alert('请输入用户名！')
                document.getElementById('username').focus();
                return false
            }
            if (document.getElementById('password').value == "") {
                alert('请输入密码！')
                document.getElementById('password').focus();
                return false
            }
            else {
                saveInfo();
                return true;
            }
        }
 
        saveInfo = function () {
            try {
                var isSave = document.getElementById('remember_password').checked;   //保存按键是否选中
                if (isSave) {
                    var username = document.getElementById('username').value;
                    var password = document.getElementById('password').value;
                    if (username != "" && password != "") {
                        SetCookie(username, password);
                    }
                } else {
                    SetCookie("", "");
                }
            } catch (e) {
 
            }
        }
 
        function SetCookie(username, password) {
            debugger
            var Then = new Date();
            Then.setTime(Then.getTime() + 1866240000000);
            document.cookie = "username=" + username + "%%" + password + ";expires=" + Then.toGMTString();
            console.log(document.cookie);
        }
 
        function GetCookie() {
            debugger
            var nmpsd;
            var nm;
            var psd;
            var cookieString = new String(document.cookie);
            console.log(cookieString);
            var cookieHeader = "username=";
            var beginPosition = cookieString.indexOf(cookieHeader);
            cookieString = cookieString.substring(beginPosition);
            var ends = cookieString.indexOf(";");
            if (ends != -1) {
                cookieString = cookieString.substring(0, ends);
            }
            if (beginPosition > -1) {
                nmpsd = cookieString.substring(cookieHeader.length);
                if (nmpsd != "") {
                    beginPosition = nmpsd.indexOf("%%");
                    nm = nmpsd.substring(0, beginPosition);
                    psd = nmpsd.substring(beginPosition + 2);
                    document.getElementById('username').value = nm;
                    document.getElementById('password').value = psd;
                    if (nm != "" && psd != "") {
                        // document.forms[0].checkbox.checked = true;
                        document.getElementById('remember_password').checked = true;
                    }
                }
            }
        }
    </script>
</head>
<body >
<form>
    <!--onblur="GetPwdAndChk()"-->
    用户名:<input type="text" id="username">
    密 码:<input type="password" id="password">
    <input type="checkbox" id="remember_password"/>记住密码
    <input type="button" onclick="checkInCorrect()" value="进入"/>
</form>
</body>



</html>
<script>
//  window.onload = function () {
     
//     document.getElementById('username').focus(function(){
//         GetCookie();
//     });
//  }   

//记住密码复选框的点击事件
function remember(){
    var remFlag = $("input[type='checkbox']").is(':checked');
    if(remFlag==true){ //如果选中设置remFlag为true
        //cookie存用户名和密码,回显的是真实的用户名和密码,存在安全问题.
        var conFlag = confirm("记录密码功能不宜在公共场所(如网吧等)使用,以防密码泄露.您确定要使用此功能吗?");
        if(conFlag){ //确认标志
            $("#remFlag").val(true);
        }else{
            $("input[type='checkbox']").removeAttr('checked');
            $("#remFlag").val(false);
        }
    }else{ //如果没选中设置remFlag为false
        $("#remFlag").val(false);
    }
}

// 下一次访问此页面自动填充账号密码
$(document).ready(function(){
    document.getElementById('username').focus(function(){
        debugger
        GetCookie();
    });
    //记住密码功能
    var str = getCookie("loginInfo");
    str = str.substring(1,str.length-1);
    var username = str.split(",")[0];
    var password = str.split(",")[1];
    //自动填充用户名和密码
    $("#username").val(username);
    $("#pwd").val(password);
    if(str!=null && str!=""){
        $("input[type='checkbox']").attr("checked", true);
    }
});
//
//获取cookie
function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) != -1) return c.substring(name.length, c.length);
    }
    return "";
}

</script>